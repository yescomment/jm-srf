<!-- CSS Scroll Timeline polyfill -->
<script src="https://flackr.github.io/scroll-timeline/dist/scroll-timeline.js"></script>

<section id="sectionPin">
  <div class="pin-wrap-sticky">
    <div class="pin-wrap">
      <slot/>
    </div>
    <svg class="chart" viewBox="0 0 50 20">
      <!-- https://yqnn.github.io/svg-path-editor/ -->
      <path d="M 0 20 l 3 -1 l 2 0 l 3 -3 l 5 -2 l 5 3 l 4 -3 l 2 1 l 5 -5 l 5 1 l 7 -6 l 1 1 l 8 -6">
    </svg>
  </div>
</section>

<style lang="scss" is:global>
  // @supports(animation-timeline: view()) {
    @keyframes advance-slides {
      // TODO: WHY THESE VALUES
      from, 5% {
        transform: translateX(calc(-40% + 100vw));
      }
      20%, 30% {
        transform: translateX(calc(-80% + 100vw));
      }
      61%, 71% {
        transform: translateX(calc(-120% + 100vw));
      }
      90%, to {
        /* Move horizontally so that right edge is aligned against the viewport */
        transform: translateX(calc(-160% + 100vw));
      }
    }

    #sectionPin {
      /* Stretch it out, so that we create room for the horizontal scroll animation */
      height: 500vh;
      overflow: visible; /* To make position sticky work â€¦ */

      view-timeline-name: --section-pin-tl;
      view-timeline-axis: block;
    }

    .pin-wrap-sticky {
      /* Stick to Top */
      height: 100vh;
      width: 100vw;
      position: sticky;
      top: 0;

      width: 100vw;
      overflow-x: hidden;
    }

    .chart {
      position: absolute;
      bottom: 0;
      z-index: 1;

      path {
        vector-effect: non-scaling-stroke;
        stroke: var(--color-pop);
        stroke-width: 0.25rem;
        fill: none;
      }
    }

    .pin-wrap {
      height: 100vh;
      width: 250vmax;

      display: flex;
      justify-content: flex-start;
      align-items: center;

      /* Hook animation */
      will-change: transform;
      animation: linear advance-slides forwards;

      /* Link animation to view-timeline */
      animation-timeline: --section-pin-tl;
      animation-range: contain 0% contain 100%;

      > * {
        min-width: 60vmax;
        padding: 0 5vmax;
      }

      > .slide {
        flex-shrink: 0;
        width: 100vw;
        padding: 50px 10vw;
      }
    }
  // }
  </style>